/*jslint eqeq: true, plusplus: true, undef: true, sloppy: true, vars: true, forin: true, nomen: true */
!function(a){function b(b,c){function h(a,b,c){if(a.stopPropagation(),a.preventDefault(),!Y&&!k(b)&&!b.hasClass("dwa")){Y=!0;var d=b.find(".dw-ul");o(d),clearInterval(ha),ha=setInterval(function(){c(d)},oa.delay),c(d)}}function k(b){if(a.isArray(oa.readonly)){var c=a(".dwwl",N).index(b);return oa.readonly[c]}return oa.readonly}function n(b){var c='<div class="dw-bf">',d=ta[b],e=d.values?d:g(d),f=1,h=e.labels||[],i=e.values,j=e.keys||i;return a.each(i,function(a,b){f%20==0&&(c+='</div><div class="dw-bf">'),c+='<div role="option" aria-selected="false" class="dw-li dw-v" data-val="'+j[a]+'"'+(h[a]?' aria-label="'+h[a]+'"':"")+' style="height:'+L+"px;line-height:"+L+'px;"><div class="dw-i">'+b+"</div></div>",f++}),c+="</div>"}function o(b){da=a(".dw-li",b).index(a(".dw-v",b).eq(0)),ea=a(".dw-li",b).index(a(".dw-v",b).eq(-1)),ga=a(".dw-ul",N).index(b)}function r(a){var b=oa.headerText;return b?"function"==typeof b?b.call(ma,a):b.replace(/\{value\}/i,a):""}function A(){ka.temp=ua&&null!==ka.val&&ka.val!=na.val()||null===ka.values?oa.parseValue(na.val()||"",ka):ka.values.slice(0),J()}function B(b){var c,d,e=window.getComputedStyle?getComputedStyle(b[0]):b[0].style;return s?(a.each(["t","webkitT","MozT","OT","msT"],function(a,b){if(void 0!==e[b+"ransform"])return c=e[b+"ransform"],!1}),c=c.split(")")[0].split(", "),d=c[13]||c[5]):d=e.top.replace("px",""),Math.round(K-d/L)}function C(a,b){clearTimeout(qa[b]),delete qa[b],a.closest(".dwwl").removeClass("dwa")}function D(a,b,c,d,e){var f=(K-c)*L,g=a[0].style;f==sa[b]&&qa[b]||(d&&f!=sa[b]&&F("onAnimStart",[N,b,d]),sa[b]=f,g[u+"Transition"]="all "+(d?d.toFixed(3):0)+"s ease-out",s?g[u+"Transform"]="translate3d(0,"+f+"px,0)":g.top=f+"px",qa[b]&&C(a,b),d&&e&&(a.closest(".dwwl").addClass("dwa"),qa[b]=setTimeout(function(){C(a,b)},1e3*d)),ra[b]=c)}function E(b,c,d,e,f){!1!==F("validate",[N,c,b])&&(a(".dw-ul",N).each(function(d){var g=a(this),h=a('.dw-li[data-val="'+ka.temp[d]+'"]',g),i=a(".dw-li",g),j=i.index(h),k=i.length,l=d==c||void 0===c;if(!h.hasClass("dw-v")){for(var m=h,n=h,o=0,p=0;j-o>=0&&!m.hasClass("dw-v");)o++,m=i.eq(j-o);for(;j+p<k&&!n.hasClass("dw-v");)p++,n=i.eq(j+p);(p<o&&p&&2!==e||!o||j-o<0||1==e)&&n.hasClass("dw-v")?(h=n,j+=p):(h=m,j-=o)}h.hasClass("dw-sel")&&!l||(ka.temp[d]=h.attr("data-val"),a(".dw-sel",g).removeClass("dw-sel"),oa.multiple||(a(".dw-sel",g).removeAttr("aria-selected"),h.attr("aria-selected","true")),h.addClass("dw-sel"),D(g,d,j,l?b:.1,!!l&&f))}),M=oa.formatResult(ka.temp,ka.settings.wheels),"inline"==oa.display?J(d,0,!0):a(".dwv",N).html(r(M)),d&&F("onChange",[M]))}function F(b,d){var e;return d.push(ka),a.each([W.defaults,pa,c],function(a,c){c[b]&&(e=c[b].apply(ma,d))}),e}function G(b,c,d,e,g){c=f(c,da,ea);var h=a(".dw-li",b).eq(c),i=void 0===g?c:g,j=ga,k=e?c==i?.1:Math.abs((c-i)*oa.timeUnit):0;ka.temp[j]=h.attr("data-val"),D(b,j,c,k,g),setTimeout(function(){E(k,j,!0,d,void 0!==g)},10)}function H(a){var b=ra[ga]+1;G(a,b>ea?da:b,1,!0)}function I(a){var b=ra[ga]-1;G(a,b<da?ea:b,2,!0)}function J(a,b,c,d){va&&!c&&E(b),M=oa.formatResult(ka.temp,ka.settings.wheels),d||(ka.values=ka.temp.slice(0),ka.val=M),a&&ua&&na.val(M).trigger("change")}var K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka=this,la=a.mobiscroll,ma=b,na=a(ma),oa=v({},z),pa={},qa={},ra={},sa={},ta=[],ua=na.is("input"),va=!1,wa=function(b){!d(b)||i||k(this)||Y||(b.preventDefault(),i=!0,Z="clickpick"!=oa.mode,fa=a(".dw-ul",this),o(fa),$=void 0!==qa[ga],ca=$?B(fa):ra[ga],_=e(b,"Y"),aa=new Date,ba=_,D(fa,ga,ca,.001),Z&&fa.closest(".dwwl").addClass("dwa"),a(document).on(x,xa).on(y,ya))},xa=function(a){Z&&(a.preventDefault(),a.stopPropagation(),ba=e(a,"Y"),D(fa,ga,f(ca+(_-ba)/L,da-1,ea+1))),$=!0},ya=function(b){var c,d,e,g=new Date-aa,h=f(ca+(_-ba)/L,da-1,ea+1),j=fa.offset().top;if(g<300?(c=(ba-_)/g,d=c*c/oa.speedUnit,ba-_<0&&(d=-d)):d=ba-_,e=Math.round(ca-d/L),!d&&!$){var k=Math.floor((ba-j)/L),l=a(".dw-li",fa).eq(k),m=Z;!1!==F("onValueTap",[l])?e=k:m=!0,m&&(l.addClass("dw-hl"),setTimeout(function(){l.removeClass("dw-hl")},200))}Z&&G(fa,e,0,!0,Math.round(h)),i=!1,fa=null,a(document).off(x,xa).off(y,ya)},za=function(b){var c=a(this);a(document).on(y,Aa),c.hasClass("dwb-d")||c.addClass("dwb-a"),setTimeout(function(){c.blur()},10),c.hasClass("dwwb")&&d(b)&&h(b,c.closest(".dwwl"),c.hasClass("dwwbp")?H:I)},Aa=function(b){Y&&(clearInterval(ha),Y=!1),a(document).off(y,Aa),a(".dwb-a",N).removeClass("dwb-a")},Ba=function(b){38==b.keyCode?h(b,a(this),I):40==b.keyCode&&h(b,a(this),H)},Ca=function(a){Y&&(clearInterval(ha),Y=!1)},Da=function(b){if(!k(this)){b.preventDefault(),b=b.originalEvent||b;var c=b.wheelDelta?b.wheelDelta/120:b.detail?-b.detail/3:0,d=a(".dw-ul",this);o(d),G(d,Math.round(ra[ga]-c),c<0?1:2)}};ka.position=function(b){if(!("inline"==oa.display||O===a(window).width()&&Q===a(window).height()&&b||!1===F("onPosition",[N]))){var c,d,e,g,h,i,j,k,l,m,n,o,p=0,q=0,r=a(window).scrollTop(),s=a(".dwwr",N),t=a(".dw",N),u={},v=void 0===oa.anchor?na:oa.anchor;O=a(window).width(),Q=a(window).height(),P=window.innerHeight,P=P||Q,/modal|bubble/.test(oa.display)&&(a(".dwc",N).each(function(){c=a(this).outerWidth(!0),p+=c,q=c>q?c:q}),c=p>O?q:p,s.width(c).css("white-space",p>O?"":"nowrap")),R=t.outerWidth(),S=t.outerHeight(!0),T=S<=P&&R<=O,"modal"==oa.display?(d=(O-R)/2,e=r+(P-S)/2):"bubble"==oa.display?(o=!0,l=a(".dw-arrw-i",N),i=v.offset(),j=i.top,k=i.left,g=v.outerWidth(),h=v.outerHeight(),d=k-(t.outerWidth(!0)-g)/2,d=d>O-R?O-(R+20):d,d=d>=0?d:20,e=j-S,e<r||j>r+P?(t.removeClass("dw-bubble-top").addClass("dw-bubble-bottom"),e=j+h):t.removeClass("dw-bubble-bottom").addClass("dw-bubble-top"),m=l.outerWidth(),n=k+g/2-(d+(R-m)/2),a(".dw-arr",N).css({left:f(n,0,m)})):(u.width="100%","top"==oa.display?e=r:"bottom"==oa.display&&(e=r+P-S)),u.top=e<0?0:e,u.left=d,t.css(u),a(".dw-persp",N).height(0).height(e+S>a(document).height()?e+S:a(document).height()),o&&(e+S>r+P||j>r+P)&&a(window).scrollTop(e+S-P)}},ka.enable=function(){oa.disabled=!1,ua&&na.prop("disabled",!1)},ka.disable=function(){oa.disabled=!0,ua&&na.prop("disabled",!0)},ka.setValue=function(b,c,d,e){ka.temp=a.isArray(b)?b.slice(0):oa.parseValue.call(ma,b+"",ka),J(c,d,!1,e)},ka.getValue=function(){return ka.values},ka.getValues=function(){var a,b=[];for(a in ka._selectedValues)b.push(ka._selectedValues[a]);return b},ka.changeWheel=function(b,c){if(N){var d=0,e=b.length;a.each(oa.wheels,function(f,g){if(a.each(g,function(f,g){if(a.inArray(d,b)>-1&&(ta[d]=g,a(".dw-ul",N).eq(d).html(n(d)),!--e))return ka.position(),E(c,void 0,!0),!1;d++}),!e)return!1})}},ka.isVisible=function(){return va},ka.tap=function(a,b){var c,d;oa.tap&&a.on("touchstart.dw",function(a){a.preventDefault(),c=e(a,"X"),d=e(a,"Y")}).on("touchend.dw",function(a){Math.abs(e(a,"X")-c)<20&&Math.abs(e(a,"Y")-d)<20&&b.call(this,a),j=!0,setTimeout(function(){j=!1},300)}),a.on("click.dw",function(a){j||b.call(this,a)})},ka.show=function(b){if(oa.disabled||va)return!1;"top"==oa.display&&(U="slidedown"),"bottom"==oa.display&&(U="slideup"),A(),F("onBeforeShow",[]);var c,d=0,e="";U&&!b&&(e="dw-"+U+" dw-in");var f='<div role="dialog" class="'+oa.theme+" dw-"+oa.display+(t?" dw"+t:"")+'">'+("inline"==oa.display?'<div class="dw dwbg dwi"><div class="dwwr">':'<div class="dw-persp"><div class="dwo"></div><div class="dw dwbg '+e+'"><div class="dw-arrw"><div class="dw-arrw-i"><div class="dw-arr"></div></div></div><div class="dwwr"><div aria-live="assertive" class="dwv'+(oa.headerText?"":" dw-hidden")+'"></div>')+'<div class="dwcc">';a.each(oa.wheels,function(b,e){f+='<div class="dwc'+("scroller"!=oa.mode?" dwpm":" dwsc")+(oa.showLabel?"":" dwhl")+'"><div class="dwwc dwrc"><table cellpadding="0" cellspacing="0"><tr>',a.each(e,function(a,b){ta[d]=b,c=void 0!==b.label?b.label:a,f+='<td><div class="dwwl dwrc dwwl'+d+'">'+("scroller"!=oa.mode?'<div class="dwb-e dwwb dwwbp" style="height:'+L+"px;line-height:"+L+'px;"><span>+</span></div><div class="dwb-e dwwb dwwbm" style="height:'+L+"px;line-height:"+L+'px;"><span>&ndash;</span></div>':"")+'<div class="dwl">'+c+'</div><div tabindex="0" aria-live="off" aria-label="'+c+'" role="listbox" class="dwww"><div class="dww" style="height:'+oa.rows*L+"px;min-width:"+oa.width+'px;"><div class="dw-ul">',f+=n(d),f+='</div><div class="dwwol"></div></div><div class="dwwo"></div></div><div class="dwwol"></div></div></td>',d++}),f+="</tr></table></div></div>"}),f+="</div>"+("inline"!=oa.display?'<div class="dwbc'+(oa.button3?" dwbc-p":"")+'"><span class="dwbw dwb-s"><span class="dwb dwb-e" role="button" tabindex="0">'+oa.setText+"</span></span>"+(oa.button3?'<span class="dwbw dwb-n"><span class="dwb dwb-e" role="button" tabindex="0">'+oa.button3Text+"</span></span>":"")+'<span class="dwbw dwb-c"><span class="dwb dwb-e" role="button" tabindex="0">'+oa.cancelText+"</span></span></div></div>":"")+"</div></div></div>",N=a(f),E(),F("onMarkupReady",[N]),"inline"!=oa.display?(N.appendTo("body"),U&&!b&&(N.addClass("dw-trans"),setTimeout(function(){N.removeClass("dw-trans").find(".dw").removeClass(e)},350))):na.is("div")?na.html(N):N.insertAfter(na),F("onMarkupInserted",[N]),va=!0,W.init(N,ka),"inline"!=oa.display&&(ka.tap(a(".dwb-s span",N),function(){ka.select()}),ka.tap(a(".dwb-c span",N),function(){ka.cancel()}),oa.button3&&ka.tap(a(".dwb-n span",N),oa.button3),a(window).on("keydown.dw",function(a){13==a.keyCode?ka.select():27==a.keyCode&&ka.cancel()}),oa.scrollLock&&N.on("touchmove touchstart",function(a){T&&a.preventDefault()}),ka.position(),a(window).on("orientationchange.dw resize.dw scroll.dw",function(a){clearTimeout(V),V=setTimeout(function(){var b="scroll"==a.type;(b&&T||!b)&&ka.position(!b)},100)}),ka.alert(oa.ariaDesc)),a(".dwwl",N).on("DOMMouseScroll mousewheel",Da).on(w,wa).on("keydown",Ba).on("keyup",Ca),N.on(w,".dwb-e",za).on("keydown",".dwb-e",function(b){32==b.keyCode&&(b.preventDefault(),b.stopPropagation(),a(this).click())}),F("onShow",[N,M])},ka.hide=function(b,c){if(!va||!1===F("onClose",[M,c]))return!1;a(".dwtd").each(function(){a(this).prop("disabled",!1).removeClass("dwtd"),a(this).data("autocomplete")?a(this).attr("autocomplete",a(this).data("autocomplete")):a(this).removeAttr("autocomplete")}),N&&("inline"!=oa.display&&U&&!b?(N.addClass("dw-trans").find(".dw").addClass("dw-"+U+" dw-out"),setTimeout(function(){N.remove(),N=null},350)):(N.remove(),N=null),a(window).off(".dw")),sa={},va=!1,ja=!0,na.focus()},ka.select=function(){!1!==ka.hide(!1,"set")&&(J(!0,0,!0),F("onSelect",[ka.val]))},ka.alert=function(a){m.text(a),clearTimeout(l),l=setTimeout(function(){m.text("")},5e3)},ka.cancel=function(){!1!==ka.hide(!1,"cancel")&&F("onCancel",[ka.val])},ka.init=function(a){W=v({defaults:{},init:q},la.themes[a.theme||oa.theme]),X=la.i18n[a.lang||oa.lang],v(c,a),v(oa,W.defaults,X,c),ka.settings=oa,na.off(".dw");var b=la.presets[oa.preset];b&&(pa=b.call(ma,ka),v(oa,pa,c)),K=Math.floor(oa.rows/2),L=oa.height,U=oa.animate,va&&ka.hide(),"inline"==oa.display?ka.show():(A(),ua&&(void 0===ia&&(ia=ma.readOnly),ma.readOnly=!0,oa.showOnFocus&&na.on("focus.dw",function(){ja||ka.show(),ja=!1})),oa.showOnTap&&ka.tap(na,function(){ka.show()}))},ka.trigger=function(a,b){return F(a,b)},ka.option=function(a,b){var c={};"object"==typeof a?c=a:c[a]=b,ka.init(c)},ka.destroy=function(){ka.hide(),na.off(".dw"),delete p[ma.id],ua&&(ma.readOnly=ia)},ka.getInst=function(){return ka},ka.values=null,ka.val=null,ka.temp=null,ka._selectedValues={},ka.init(c)}function c(a){var b;for(b in a)if(void 0!==r[a[b]])return!0;return!1}function d(a){if("touchstart"===a.type)k=!0;else if(k)return k=!1,!1;return!0}function e(a,b){var c=a.originalEvent,d=a.changedTouches;return d||c&&c.changedTouches?c?c.changedTouches[0]["page"+b]:d[0]["page"+b]:a["page"+b]}function f(a,b,c){return Math.max(b,Math.min(a,c))}function g(b){var c={values:[],keys:[]};return a.each(b,function(a,b){c.keys.push(a),c.values.push(b)}),c}function h(a,c,d){var e=a;return"object"==typeof c?a.each(function(){this.id||(o+=1,this.id="mobiscroll"+o),p[this.id]=new b(this,c)}):("string"==typeof c&&a.each(function(){var a,b=p[this.id];if(b&&b[c]&&void 0!==(a=b[c].apply(this,Array.prototype.slice.call(d,1))))return e=a,!1}),e)}var i,j,k,l,m,n=new Date,o=n.getTime(),p={},q=function(){},r=document.createElement("modernizr").style,s=c(["perspectiveProperty","WebkitPerspective","MozPerspective","OPerspective","msPerspective"]),t=function(){var a,b=["Webkit","Moz","O","ms"];for(a in b)if(c([b[a]+"Transform"]))return"-"+b[a].toLowerCase();return""}(),u=t.replace(/^\-/,"").replace("moz","Moz"),v=a.extend,w="touchstart mousedown",x="touchmove mousemove",y="touchend mouseup",z={width:70,height:40,rows:3,delay:300,disabled:!1,readonly:!1,showOnFocus:!0,showOnTap:!0,showLabel:!0,wheels:[],theme:"",headerText:"{value}",display:"modal",mode:"scroller",preset:"",lang:"en-US",setText:"Set",cancelText:"Cancel",ariaDesc:"Select a value",scrollLock:!0,tap:!0,speedUnit:.0012,timeUnit:.1,formatResult:function(a,b){return a.join(" ")},parseValue:function(b,c){var d,e=b.split(" "),f=[],h=0;return a.each(c.settings.wheels,function(b,c){a.each(c,function(b,c){c=c.values?c:g(c),d=c.keys||c.values,-1!==a.inArray(e[h],d)?f.push(e[h]):f.push(d[0]),h++})}),f}};a(function(){m=a('<div class="dw-hidden" role="alert"></div>').appendTo("body")}),a(document).on("mouseover mouseup mousedown click",function(a){if(j)return a.stopPropagation(),a.preventDefault(),!1}),a.fn.mobiscroll=function(b){return v(this,a.mobiscroll.shorts),h(this,b,arguments)},a.mobiscroll=a.mobiscroll||{setDefaults:function(a){v(z,a)},presetShort:function(a){this.shorts[a]=function(b){return h(this,v(b,{preset:a}),arguments)}},has3d:s,shorts:{},presets:{},themes:{},i18n:{}},a.scroller=a.scroller||a.mobiscroll,a.fn.scroller=a.fn.scroller||a.fn.mobiscroll}(jQuery);